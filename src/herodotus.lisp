(defpackage herodotus
  (:use :cl :yason)
  (:export
   #:to-json
   #:define-json-model))

(in-package :herodotus)

(defgeneric to-json (class))

(defun json-package-name (class-name)
  (concatenate 'string (symbol-name class-name) "-JSON"))

(defun make-keyword (sym)
  (let ((name (symbol-name sym)))
    (intern name "KEYWORD")))

(defun camel-case (str)
  (let ((parts (cl-ppcre:split "-+" str)))
    (format nil "狺ㄣ镱ㄣ狎疳螋螬磲疸狎＇篝蜷铉汜痖翎扉ㄣ潋疳螋螬┅┅ㄤ彐躅箢犭瀛汜箦篝颟ㄣ飙痧泸搴蝈珏蝈痨徙瀛犰篝⑦┅ㄤ彐躅磲脲栳箬疳蝮弪钺礤ㄣ灬篌钺礤戾è钺礤牦镱疳汶徵瀛钺礤沆狍蟓钺礤┅ㄩㄦ轭洵疳汶徵钺礤ㄩ铘弪⑵蚁铜攘尤钺礤ㄥ蝌矧ㄦ矧磲铋⒚秕熹铒骈钿疳蝮弪骘沆狍岙徐遽箦溴骈铄牦镱盹溴骘轸沆狍蟓钺礤┅┅ㄤ彐躅筱蝈犴轭绛箢犭瀛汜箦篝颟篝蜷铉躔汜箦箢犭瀛汜箦篝颟┅ㄤ彐躅栳蟓沲篝镯脲ㄡ钿ㄣ镱箴ㄣ徜┅ㄤ彐躅磲脲脲箪雉汜箦骖磲疸狎灬礅溽箪雉ㄩㄨ狍沲篝镯脲箪雉ㄣ徜箪雉ㄦ躅汜祆汜箦骖篝蜷铉滹黝汜箦簌礅镬钺礤ㄧ弭箪雉箪雉┅┅┅箪雉螬ㄤ彐躅栳蟓镡赍泗泔铙趄蹉麸箪雉ㄡ钿ㄣ镱箴箪雉ㄣ徜潋箪雉┅ㄤ彐躅磲脲篝犷溽蜾箪雉ㄩ铋舡狎脲牦镱镡戛啜轭轸狎ㄧ弭栳箬脲牦镱镡戛┅ㄤ彐躅珏舡箪雉豉疱箪雉ㄣ徜潋箪雉┅ㄤ彐躅磲脲镡赍泗箪雉ㄩ铋舡狎脲箪雉牦镱镡戛戾舄è栳箬疳蝮弪钺礤磲脲栳箬疳蝮弪钺礤ㄧ弭箪雉豉疱箪雉┅┅啜轭轸狎ì栳箬疳蝮弪钺礤ㄧ弭栳箬脲牦镱镡戛┅┅ㄤ彐磲泸溴骈铄牦镱泔铙趄蹉麸ㄣ灬篌钺礤箪雉汜箦骖戾舄è脲磲脲脲箪雉汜箦骖┅ㄩ铋舡狎珞磲疸狎＇磲脲轭轸狎箪雉螬ㄨ狍璀疳蝮弪钺礤磲脲栳箬疳蝮弪钺礤沆狍蟓钺礤┅ㄡ戾犷潋獒瑚轸璀珏铙眢牦镱镡戛戾è泔铙趄蹉麸颦疳蜥眢ㄡ痧禊＇狃疱钿祜镳骘脲轭脲骘轭轸狎轭轭轸狎珞骘箪雉轭箪雉泔祆邈ㄩㄨ狍镡赍泗泔铙趄蹉麸箪雉磲脲镡赍泗箪雉轭轸狎脲箪雉牦镱镡戛磲脲篝犷溽蜾箪雉轭轸狎脲牦镱镡戛┅┅啜溴骢栳箬疳蝮弪钺礤ì牦镱镡戛ㄨ犷潇弪汜箦ㄣ镱è铛祆牦镱镡戛鲥泗矧┅è鲥泗矧牦镱镡戛磲鲥泗矧＇栳箬疳蝮弪钺礤牦镱镡戛磲脲轭篝犷沐К沆狍蟓钺礤楞镱篝蝓泗矧疳蜥眢┅┅┅┅ㄤ彐磲泸溴骈铄疳蝮弪ㄣ灬篌钺礤箪雉汜箦骖戾舄è栳箬疳蝮弪钺礤磲脲栳箬疳蝮弪钺礤沆狍蟓钺礤┅ㄡ戾犷潋獒瑚轸璀珏铙眢牦镱镡戛啜痱镧ㄤ彐轭瀛牦镱泔铙趄蹉麸沆狍蟓钺礤箪雉汜箦骖ㄤ彐躅ㄩ铘弪⑵蚁铜视衔牦镱疳汶徵瀛钺礤沆狍蟓钺礤┅牦镱戾舄è狍镱邯疳蝮瀛牦镱狎蜥蟓狍鲥泗矧螵舂ì牦镱镡狍镱吼狎箦牦镱┅ì栳箬疳蝮弪钺礤牦镱镡戛┅┅┅ㄤ彐躅箪雉徙沐篌矧箪雉溴筱蜷痿轱瞟ㄩㄣ镱箴箪雉溴筱蜷痿轱瞟ㄣ狎箪雉溴筱蜷痿轱瞟箪雉溴筱蜷痿轱瞟ㄤ彐磲泸溴骈铄孱泔溴ㄣ灬篌钺礤箪雉汜箦骖ㄦ矧磲沆狍蟓钺礤箪雉狺ア沆狍蟓钺礤箪雉螬戾è脲磲脲脲箪雉汜箦骖┅ㄡ戾犷潋獒瑚轸璀珏铙眢ㄣ祜蟓镡戛戾è孱泔溴颦疳蜥礤翦蝮祜镳骘箪雉轭箪雉骘脲轭脲泔祆邈扉篝狍镱哄钽镤瀛镡赍泗屐屙孱脲扉篝箪雉徙沐篌矧箪雉沆矬镡戛┅┅啜痱镧ㄤ彐礤翳镤狍镱哄钽镤瀛箪雉痱镧è沆矬镡沆狍蟓钺礤┅厘钽镤弪疳蜥礤翦蝮ㄤ彐礤翳镤桢蝻滹趱蠛麸牦镱è沆矬镡沆狍蟓钺礤┅狍镱瑚轸璀秕麴豸麸篝蜷铉īㄥ钽镤瀛镡赍泗沆矬镡戛┅┅┅ㄤ彐躅珏舡箪雉箪雉箴邈ㄩㄣ镱箴箪雉箴邈ㄣ狎箪雉箴邈箪雉箴邈┅ㄤ彐躅磲脲轭轸狎箪雉箴邈磲脲脲黠蜾ㄧ弭箪雉箪雉箴邈┅ㄤ彐躅珏舡箪雉溴骟箪雉箴邈螬祜镳骘箪雉箴邈轭箪雉箴邈泔祆邈戾è箪雉ㄧ弭箪雉箪雉箴邈┅ㄩ铋舡狎磲脲轭轸狎箪雉箴邈┅啜箪雉横沣弩箫箪雉洪铋翎蜱轭轸狎绌┅ㄤ彐躅箦戾泗汜箦骢钽糸镱ㄣ狍瀛豉疱ㄣ狍汜箦豉疱ê汜礤飙汜箦＇汜礤飙汜箦ê箢犭瀛汜箦＇箢犭瀛汜箦ê筱蝈犴轭绛箢犭瀛汜箦＇筱蝈犴轭绛箢犭瀛汜箦ê脲忉猸汜箦＇殇孱糸豉ㄥ蝌矧ㄦ矧磲铋⒄铍铒黝汜箦豉疱岈屮疱泗邃镱镦恒犴屐汜箦后钺脲汜箦后泸遽黹铉箢犭瀛汜箦矧弘邂徕汜箦汜箦豉疱┅┅ㄤ彐磲泸鏖翳轭疳汶徵疳汶徵瀛钺礤蝈篝怙澌戾è轭轸獒飙疳汶徵疳汶徵瀛钺礤疳汶徵濯┅啜痱镧ㄩ瞽疳汶徵疳汶徵瀛钺礤棱镤ㄩ瞽疳汶徵轭轸獒飙疳汶徵濠┅ㄤ彐磲泸溴骈铄牦镱盹溴钺礤箪雉镳糸镱犰ㄣ狍瀛豉疱恒犴屐汜箦┅戾è箪雉溴骟ㄧ弭箪雉溴骟箪雉螬ㄣ狍瀛骖箦戾泗汜箦骢钽糸镱汜箦豉疱┅ㄩ铋糸犰疳汶徵疳汶徵瀛钺礤疳汶徵濯┅啜痱镧ㄤ彐沆狍钺礤ī箪雉溴骟ㄤ彐疳汶徵牦镱疳汶徵瀛钺礤钺礤ê躞恒鸿弪镤雉躞葫狍镱ê屮痫螋：骝镯牦镱：麸牦镱：骝镯栳箬┅ㄩ瞽疳汶徵牦镱疳汶徵瀛钺礤钺礤┅ㄤ彐轭瀛孱泔溴钺礤箪雉汜箦骖ㄤ彐轭瀛疳蝮弪钺礤箪雉汜箦骖ㄩ瞽疳汶徵轭轸獒飙疳汶徵濠┅